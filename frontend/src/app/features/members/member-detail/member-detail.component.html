<mat-card class="flags-card">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>flag</mat-icon>
      Account Flags
    </mat-card-title>
    <button
      mat-raised-button
      color="primary"
      (click)="openAddFlagDialog()"
      class="add-flag-button"
    >
      <mat-icon>add</mat-icon>
      Add Flag
    </button>
  </mat-card-header>

  <mat-card-content>
    @if (getActiveFlags().length > 0) {
      <h3>Active Flags</h3>
      <mat-list>
        @for (flag of getActiveFlags(); track flag.id) {
          <mat-list-item>
            <div class="flag-item">
              <div class="flag-header">
                <mat-chip [color]="getFlagColor(flag.flagType)" highlighted>
                  {{ flag.flagType }}
                </mat-chip>
                <span class="flag-date">{{
                  flag.createdAt | date: "short"
                }}</span>
              </div>
              <p class="flag-description">{{ flag.description }}</p>
              <div class="flag-footer">
                <span class="flag-creator"
                  >Created by: {{ flag.createdBy }}</span
                >
                <button mat-button color="primary" (click)="resolveFlag(flag)">
                  <mat-icon>check_circle</mat-icon>
                  Resolve
                </button>
              </div>
            </div>
          </mat-list-item>
          <mat-divider></mat-divider>
        }
      </mat-list>
    } @else {
      <p class="no-data">No active flags</p>
    }

    @if (getResolvedFlags().length > 0) {
      <h3 style="margin-top: 24px">Resolved Flags</h3>
      <mat-list>
        @for (flag of getResolvedFlags(); track flag.id) {
          <mat-list-item>
            <div class="flag-item resolved">
              <div class="flag-header">
                <mat-chip>{{ flag.flagType }}</mat-chip>
                <span class="flag-date">
                  Resolved: {{ flag.resolvedAt | date: "short" }}
                </span>
              </div>
              <p class="flag-description">{{ flag.description }}</p>
              @if (flag.resolutionNotes) {
                <p class="resolution-notes">
                  <strong>Resolution:</strong> {{ flag.resolutionNotes }}
                </p>
              }
              <span class="flag-creator">
                Resolved by: {{ flag.resolvedBy }}
              </span>
            </div>
          </mat-list-item>
          <mat-divider></mat-divider>
        }
      </mat-list>
    }
  </mat-card-content>
</mat-card>
